<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorate="layout">
    <head>
        <title>Faber Airline</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <link rel="stylesheet" th:href="@{/css/style.css}"/>

    </head>
    <body class="background-searchpage">
        <div layout:fragment="content">
            <div class="container ">
                <div class="card search-card">

                    <div class="card-body search-content">
                        <div class="row row-spacing" ><h5 class="card-title col">Choose your flight - Hello <span th:text="${session.user}">customer</span></h5></div>
                        <form action="#" th:action="@{/flight/search}" th:object="${orderModel}"
                              method="post" id='form-flight-search'>
                            <div class="row row-spacing">
                                <div class="col col-2">
                                    <select class="form-control" th:field="*{returnType}" id="return_type">
                                        <option th:value="1" >Round Trip</option>
                                        <option th:value="0">One way</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row row-spacing">
                                <div class="col col-4">
                                    <label for="usr">From: </label>
                                    <div>
                                        <select th:field="*{departureAirportId}"  class="form-control" id="departure_airport_id">
                                            <option th:each="airport: ${airportList}" 
                                                    th:value="${airport.id}" th:text="${airport.name + ' ('+ airport.location+')'}"></option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col col-4">
                                    <label for="usr">To: </label>
                                    <div>
                                        <select th:field="*{arrivalAirportId}"  class="form-control" id="arrival_airport_id">
                                            <option th:each="airport: ${airportList}" 
                                                    th:value="${airport.id}" th:text="${airport.name + ' ('+ airport.location+')'}"></option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col col-4">
                                    <label for="usr">Number of passengers: </label>
                                    <div>
                                        <select class="form-control" th:field="*{numOfPassengers}">
                                            <option th:value="1">1</option>
                                            <option th:value="2">2</option>
                                            <option th:value="3">3</option>
                                            <option th:value="4">4</option>
                                            <option th:value="5">5</option>
                                            <option th:value="6">6</option>
                                            <option th:value="7">7</option>
                                            <option th:value="8">8</option>
                                            <option th:value="9">9</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row row-spacing">
                                <div class="col col-4">
                                    <label for="">Departure Date: </label>
                                    <input th:field="*{departureDate}" type="date" class="form-control" id="departure_date" />
                                </div>
                                <div class="col col-4">
                                    <label for="">Return Date: </label>
                                    <input th:field="*{returnDate}" type="date" class="form-control" id="return_date" />
                                </div>
                                <div class="col col-4">
                                    <button class="btn btn-primary form-control btn-search-flight" type="submit">Search flight</button>
                                </div>

                            </div>
                        </form>
                    </div>
                </div>
                <script>
                    function formatDate(date) {
                        var dd = date.getDate();
                        var mm = date.getMonth() + 1;
                        var yyyy = date.getFullYear();
                        if (dd < 10) {
                            dd = '0' + dd
                        }
                        if (mm < 10) {
                            mm = '0' + mm
                        }
                        var today = yyyy + '-' + mm + '-' + dd;
                        return today;
                    }

                    $(document).ready(function () {
                        var today = formatDate(new Date());
                        $('#departure_date').val(today);
                        $('#return_date').val(today);
                        $("#departure_date").attr("min", today);
                        $("#return_date").attr("min", today);

                        $("#departure_date").change(function () {
                            var departure_date = $(this).val();
                            var return_date = $("#return_date").val();
                            if (departure_date > return_date) {
                                $('#return_date').val(departure_date);
                            }
                            $("#return_date").attr("min", departure_date);
                        });

                        $("#return_type").on("change", function () {
                            var returnTypeValue = $(this).val();
                            if (returnTypeValue == 0) {
                                $("#return_date").attr("disabled", true);
                            } else {
                                $("#return_date").attr("disabled", false);
                            }
                        })
                    })
                </script>
            </div>

    </body>
</html>
